/*!
 * pbjs JavaScript Framework v0.6.0
 * http://saartje87.github.com/pbjs
 *
 * Includes Qwery
 * https://github.com/ded/qwery
 *
 * Copyright 2013 Niek Saarberg
 * Licensed MIT
 *
 * Build date 2013-03-06 10:03
 */
(function(e,t,n){this[e]=n(t)})("PB",this,function(e){"use strict";function u(e,t){return function(){var n=this.parent,r;return this.parent=t,r=e.apply(this,arguments),this.parent=n,r}}function y(e){var t;return e.length===2&&(t={},t[e[0]]=e[1]),t||e[0]}function b(e,n){var r="",i,s,o=t.type(e);if(o!=="array"&&o!=="object")throw new TypeError(o+" given.");if(o==="array"||o==="object")for(i in e)e.hasOwnProperty(i)&&(s=e[i],s!==null&&typeof s=="object"?r+=b(s,n?n+"["+i+"]":i):r+=encodeURIComponent(n?n+(o==="array"?"[]":"["+i+"]"):i)+"="+encodeURIComponent(s)+"&");return n?r:r.replace(/&$/,"")}function w(e){var t={},n;return e=e.indexOf("?")!==-1?e.substr(e.indexOf("?")+1):e,e.split("&").forEach(function(e){n=e.split("="),t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}),t}var t={},n=e.PB,r=n?n.id():0,i=Array.prototype.slice,s=Object.prototype.toString,o;t.VERSION="0.6.0",t.id=function(){return++r},t.overwrite=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},t.extend=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&e[n]===o&&(e[n]=t[n]);return e},t.clone=function(e){var n,r;if(e===null||typeof e!="object")return e;n=t.type(e)==="object"?{}:[];for(r in e)e.hasOwnProperty(r)&&(n[r]=t.clone(e[r]));return n},t.each=function(e,t,n){var r;if(!e||typeof t!="function")return;for(r in e)if(e.hasOwnProperty(r)&&t.call(n,r,e[r],e)===!0)return},t.toArray=function(e){if(s.call(e)==="[object Object]"&&e.length){var t=[],n=e.length,r=0;for(;r<n;r++)t[r]=e[r];return t}return i.call(e)},t.type=function(e){var t=s.call(e);return t.substr(8,t.length-9).toLowerCase()},t.noConflict=function(){return f.PB===t&&(f.PB=n),t},t.Class=function(e,n){var r,i,s,o,a,f;n?f=e.prototype:(n=e,e=null),r=n.construct;if(typeof r=="function")if(e&&f.construct){var l;i=function(){var e=r;r=function(){var t=this.parent;this.parent=f.construct,e.apply(this,arguments),this.parent=t},typeof r=="function"&&r.apply(this,arguments)}}else i=n.construct;else e&&f.construct?i=function(){f.construct.apply(this,arguments)}:i=function(){};for(s in n)n.hasOwnProperty(s)&&(a=n[s],o=e?f[s]:!1,typeof o=="function"&&typeof a=="function"&&(a=u(a,o)),i.prototype[s]=a);return e&&t.extend(i.prototype,f),i},t.Observer=t.Class({construct:function(){this.listeners={}},on:function(e,t,n){var r=e.split(" "),i=r.length;if(typeof t!="function")throw new TypeError("PB.Observer error, fn is not a function");while(i--)e=r[i],this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push({fn:t,context:n});return this},off:function(e,t){var n=this.listeners[e],r;if(!e)return this.listeners={},this;if(!n)return this;if(!t)return n.length=0,this;r=n.length;while(r--)n[r].fn===t&&n.splice(r,1);return n.length||delete this.listeners[e],this},emit:function(e){var t=this.listeners[e],n=i.call(arguments,1),r=0;if(!t)return this;for(;r<t.length;r++)t[r].fn.apply(t[r].context,n);return this}});var a,f=e,l=f.document,c=l.documentElement,h=l.body;t.$=function(e){if(!e)return null;if(e.nodeType)return new a(e);if(typeof e=="string"){if(e.charAt(0)==="#")return e=l.getElementById(e.substr(1)),e?new a(e):null;e.charAt(0)==="<"&&e.charAt(e.length-1)===">"}return null},t.$.cache={},t.$$=function(e){return(new a(document)).find(e)},a=function(e){var t=0;if(e.length)for(t=0;t<e.length;t++)this[t]=e[t];else this[0]=e;this.length=t||1,this.context=this[0]},a.prototype.constructor=a,t.$.fn=a.prototype,t.$.hooks={},t.$.hook=function(e,n){if(typeof n!="function")throw new TypeError("fn must be a function");t.$.hooks[e]=n};var p=document.createElement("div"),d="O ms Moz Webkit".split(" "),v="animationName transform transition transitionProperty transitionDuration transitionTimingFunction boxSizing backgroundSize boxReflect".split(" "),m={"float":p.style.cssFloat!==o?"cssFloat":"styleFloat"},g={zIndex:!0,zoom:!0,fontWeight:!0,opacity:!0};return t.each(v,function(e,t){var n;if(t in p.style)return;n=t.charAt(0).toUpperCase()+t.substr(1),e=d.length;while(e--)if(d[e]+n in p.style)return m[t]=d[e]+n}),p=null,t.overwrite(a.prototype,{setStyle:function(e){var n=0,r,i;e=y(arguments);for(;n<this.length;n++)for(r in e){i=e[r];if(t.$.hooks["setStyle."+r])t.$.hooks["setStyle."+r](this[n],i);else{typeof i=="number"&&!g[r]&&(i+="px");try{this[n].style[m[r]||r]=i}catch(s){}}}return this},getStyle:function(e,t){var n;e=m[e]||e,n=this[0].style[e];if(t||!n||n==="auto")n=l.defaultView.getComputedStyle(this[0],null).getPropertyValue(e);return e==="opacity"?n?parseFloat(n):1:/^-?[\d.]+px$/i.test(n)?parseInt(n,10):n}}),t.overwrite(a.prototype,{hasClass:function(e){return(" "+this.context.className+" ").indexOf(" "+e+" ")>=0},addClass:function(e){var t=0,n=e.split(" "),r,i;for(;t<this.length;t++){r=" "+this[t].className+" ";for(i=0;i<n.length;i++){if(r.indexOf(" "+n[i]+" ")>=0)continue;this[t].className+=(this[t].className?" ":"")+n[i]}}return this},removeClass:function(e){var t=0,n=e.split(" "),r=n.length,i,s;for(;t<this.length;t++){i=" "+this[t].className+" ";for(s=0;s<r;s++)i.indexOf(" "+n[s]+" ")>=0&&(i=i.replace(" "+n[s]+" "," "));i=i.replace(/^\s|\s$/g,""),i?this[t].className=i:this[t].removeAttribute("class")}return this},setData:function(e){var n=0,r,i;e=y(arguments);for(;n<this.length;n++)i=this[n].__PBID__||(this[n].__PBID__=t.id()),r=t.$.cache[i]||(t.$.cache[i]={}),r.data=r.data||{},t.overwrite(r.data,e);return this},getData:function(e){var n=this[0].__PBID__||(this[0].__PBID__=t.id()),r;return t.$.cache[n]&&t.$.cache[n].data?r=t.$.cache[n].data[e]:r=this[0].getAttribute("data-"+e),r},removeData:function(e){var n=0,r,i;for(;n<this.length;n++){this[n].removeAttribute("data-"+e),i=this[n].__PBID__,r=t.$.cache[i];if(!r||!r.data)continue;delete r.data[e]}return this},setAttr:function(e){var t=0,n;e=y(arguments);for(;t<this.length;t++)for(n in e)this[t].setAttribute(n,e[n]);return this},getAttr:function(e){return this[0].getAttribute(e)},removeAttr:function(e){var t=0;for(;t<this.length;t++)this[t].removeAttribute(e);return this},setValue:function(){},getValue:function(){},show:function(){},hide:function(){},isVisible:function(){}}),t.Request=t.Class(t.Observer,{stateTypes:"unsent opened headers loading end".split(" "),transport:null,construct:function(e){this.options=t.clone(t.Request.defaults),this.parent(),t.overwrite(this.options,e)},send:function(){var e=this.options,n=e.async,r=this.getTransport(),i=e.url,s=e.method.toUpperCase(),o=t.type(e.data)==="object"?t.Request.buildQueryString(e.data):e.data;return o&&(s==="GET"||s==="PUT")&&(i+=(i.indexOf("?")===-1?"?":"&")+o,o=null),n&&(r.onreadystatechange=this.onreadystatechange.bind(this)),r.open(s,i,n),(s==="POST"||s==="PUT")&&r.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset="+this.charset),t.each(e.headers,function(e,t){r.setRequestHeader(e,t)}),this.emit("send",this.transport,0),r.send(o||null),n||this.onreadystatechange(),this},abort:function(){return this.transport.abort(),this.emit("abort"),this},set:function(e,n){return e.substr(0,6)==="header"&&t.overwrite(this.options.headers,n),this.options[e]=n,this},getTransport:function(){if(this.transport&&f.XMLHttpRequest)return this.transport;if(f.XMLHttpRequest)return this.transport=new XMLHttpRequest;this.transport&&this.transport.abort();try{return this.transport=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(e){}throw new Error("Browser doesn`t support XMLHttpRequest")},onreadystatechange:function(){var e=this.transport,t=this.options,n="error";if(e.readyState===4){e.responseJSON=null;if(e.status>=200&&e.status<300){if(t.json||e.getResponseHeader("Content-type").indexOf("application/json")>=0)try{e.responseJSON=JSON.parse(e.responseText)}catch(r){}n="success"}this.emit(n,e,e.status,n),this.transport.onreadystatechange=null}n=this.stateTypes[e.readyState],this.emit(n,e,e.readyState===4?e.status:0,n)}}),t.Request.defaults={url:"",method:"GET",async:!0,json:!1,xml:!1,data:null,auth:null,headers:{"X-Requested-With":"PBJS-"+t.VERSION,Accept:"text/javascript, text/html, application/xml, text/xml, */*"},encoding:"UTF-8",timeout:0},t.overwrite(t.Request,{buildQueryString:b,parseQueryString:w}),t});